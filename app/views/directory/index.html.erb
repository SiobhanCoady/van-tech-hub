<h1>DIRECTORY</h1>

<style>
   #map {
    height: 400px;
    width: 100%;
   }
</style>

<div id="map"></div>
<script>
  function initMap() {
    const center = {lat: 49.2837745, lng: -123.1146751};
    let orgs = <%= raw @orgs %>;
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 13,
      center: center
    });
    for (var i = 0; i < orgs.length; i++) {
      var org = orgs[i];
      var marker = new google.maps.Marker({
        position: {lat: org[1], lng: org[2]},
        map: map,
        title: org[0],
        zIndex: org[3]
      });
    }
  }
</script>
<script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyjDO7vP98P6enrMggLCskPciKco8oB9A&callback=initMap">
</script>

<%= form_tag(directory_index_path, :method => "get", id: "search-form") do %>
    <%= text_field_tag :search, params[:search], placeholder: "Search Organizations" %>
    <%= submit_tag "Search", :name => nil %>
<% end %>

<% if @organizations %>
    <% @organizations.each do |organization| %>
      <p><%= organization.name %></p>
      <hr>
    <% end %>
<% end %>
